План рассказа:

1. Вступление, цели, предмет исследования, объект исследования
2. Теория насчет эмбоссеров, эмбоссера MATICA, FloraWare и CardFactory
3. Описание работы драйвера + схема
3. Актуальность работы
4. Готовое решение

1. Здравствуйте уважаемая аттестационная коммиссия, сегодня я хочу представить свою выпускную квалификационную работу
на тему "Разработка программной библиотеки для осуществления прямого управления эмбоссером MATICA через TranzWare CardFactory".

Начнем с того, что осветим необходимые для понимания сути работы моменты. Компонентами работы, 
для которых необходим подробный разбор, это: 
-эмбоссер MATICA
-технологическая платформа FloraWare 
-программный продукт CardFactory

1. Изначально, еще в 1914 году, когда компания Mobil Oil выпустила свои первые платежные карты они были картонными
и данные владельцев или печатались на них чернилами или выдавливались тиснением. Позже, в 1928 году бостонская компания
"Farrington Manufacturing" выпустила металлические пластинки, выпступающие в роли торговых чеков-слипов. Они были созданы
дабы избежать ошибок во время заполнения данных, ускорить процесс выпуска и сделать карты более надежными. 
Данные на них выдавливались вручную или специальными механическими эмбоссерами. 
Сегодня же, в эру копьютерных технологий и продвинутых материалов, карты состоят из пластика, и кроме того, что часть данных
о карте до сих пор выдавливается на ней, все основные данные клиента записываются на специальный чип, встроенный в нее.

2. С развитием стандартов выпуска банковких карт, модернизировались и эмбоссеры, занимающиеся их обработкой и производством.
Сейчас полноценный эмбоссер представляет из себя сложный технический комплекс, имеющий в своем составе управляющую ЭВМ,
который способен выполнять все необходимые этапы обработки карты, такие как непосредственно эмбоссирование данных на карту, 
запись информации на чип, печать изображения на карту, перемещение карты между модулями и т.д. 
Процесс прогонки карты через эмбоссер и осуществление полноценного выпуска карты называется персонализацией
и современные эмбоссеры могут достигать производительности в несколько сотен персонализаций в час при непрерывном выпуске карт.

3. На сегодняшний день множество компаний занимается производством и поддержкой эмбоссеров, 
но подавляющее большинство клиентов, занимающихся персонализацией карт, 
пользуются именно эмбоссерами итальянской компании MATICA. На рисунке представлен один из модулей эмбоссера,
а именно модуль кардридеров. Он был отправлен в нашу компанию в качестве тестового образца для внедрения возможностей 
работы с ним в наше ПО. Данный модуль позволяет записывать информацию на чип одной карты или нескольких карт параллельно,
а также считывать ответ карты на записанные данные. 
Вы можете видеть, что модуль состоит из блока питания, управляющей платы с портом Ethernet для подключения и двух коннекторов
для кардридеров. В промышленных модулях кардридеров чаще всего больше чем два, 
в этом плане данный модуль немног урезан, но этого вполне достаточно для разработки и тестирования
, так как принципы работы плат одинаковые, вне зависимости от количества кардридеров.

4. Перейдем к разбору внутреннего ПО, на основании которого велась разработка. 
Разработка драйвера велась для программного продукта TranzWare CardFactory. 
CardFactory предназначен для управления процессом персонализации карт и предоставляет все необходимые для этого инструменты.
Данный программный продукт полностью построен на технологической платформе FloraWare.
Можно сказать, что FloraWare представляет из себя полноценную экосистему для разработки приложений.
Она предоставляет все необходимые инструменты для разработки и отладки приложений, управления большими проектами, 
свой язык программирования и средства для запуска разработанных в данной экосистеме приложений.






1. Здравствуйте Темой моего доклада является Поддержка прямого управления эмбоссером Matica 
и дополнение модуля для приложения TranzWare CardFactory.

2. Для начала следует осветить тему актуальности выполненного мной проекта. 
Выполненный проект представляет собой драйвер для управления эмбоссером итальянской компании MATICA через корпоративное приложения CardFactory.
Драйвер не осуществляет работу со всем эмбоссером в целом, но только с кардридерами, являющимися его частью.
Он позволяет напрямую записывать карты с помощью CardFactory, 
минуя необходимость выполнения данной операции через специализированное приложение для работы с эмбоссерами MATICA.
Необходимость использования приложения все еще присутствует, но этап записи карты теперь обрабатывается нашим приложением,
следовательно при необходимости можно использовать любой доступный в CardFactory драйвер записи карты для данной операции.

2. Для начала вкратце расскажу об основных возможностях приложения CardFactory.
CardFactory является приложением для обработки и настройки карточных продуктов,
построенным на базе технологической платформы FloraWare.
В данном приложении реализованны такие возможности, как:
Настройка карточного продукта,
Обработка и запись информации на одну или несколько физических карт через один из поддержанных кардридеров

3.Для того, чтобы успешно обработать карточный продукт средствами CardFactory 
нужно провести его предварительную настройку.
Во-первых, внутри TWCF нужно создать экземпляр карточного продукта.
Любой карточный продукт внутри CardFactory представляет из себя набор модулей и их настроек,
Внутри карточного продукта пользователь может выполнять с модулями различные операции, а именно:
добавлять, удалять, менять их последовательность запуска при обработке, 
а также переходить во внутреннюю часть модуля для его непосредственной настройки.
Каждый модуль отвечает за отдельный этап обработки карты, 
когда процесс обработки будет запущен, каждый модуль будет выполнять свою работу в том порядке, 
который был выставлен пользователем при настройке карточного продукта.

4. После того, 
как карточный продукт был успешно настроен можно переходить к записи физической карты.
При настройке карточного продукта в модуле ChipWriterDriver, 
который реализует общение с кардридерами, а также запись информации через кардридер на карту,
для успешной обработки карты пользователь должен выбрать тип карты, которая будет обработана,
а также тип ридера, который будет использоваться для обработки.

В зависимости от типа карты и кардридера, выбранного в ChipWriterDriver, 
карта прикладывается или вставляется в ридер и обработка карты запускается через специальный
модуль Processing, присутствующий в CardFactory.

5. Моей задачей было дополнение драйвера Embosser_smartware, 
который является частью модуля ChipWriterDriver 
и отвечает за общение и работу с эмбоссерами Smartware.
Реализуемое дополнение нацелено на то, чтобы этот же драйвер имел возможность 
подключения и работы с ридерами той же серии Smartware.
Целью создания такого дополнения является переход с более старых и медленных ридеров pcsc,
на более новые и быстрые ридеры Smartware. 
При реализации данного функционала для передачи команд ридеру 
использовался скриптовый язык программирования TCPScript.
Передаются все команды по протоколу TCP. 
При получении набора команд ридер обрабатывает их и передает результат по тому же каналу подключения.

6. Так как ридеры Smartware могут работать в двух режимах: однопоточном и многопоточном.
Возникла потребность не только создания вышеупомянутого дополнения, а также дополнении модуля
ChipWriterDriver для реализации возможности подключения ридера в многопоточном режиме.
Основной причиной для изменения модуля ChipWriterDriver послужило то, 
в многопоточном режиме к одной станции подключается несколько кардридеров, 
каждый из которых имеет свой собственный IP адрес и порт.
Все адреса ридеров отсчитываются от базового IP адреса, 
например, в представленном ридере базовым IP адресом является адрес 192.168.0.80,
а адресом первого подключенного ридера служит адрес 192.168.0.81, 
следовательно при подключении ридера в многопоточном режиме, 
каждый поток обработки должен подключаться к различным IP адресам.
В модуле ChipWriterDriver была реализована возможность настройки базового адреса, 
на основе которого определяются и выставляются адреса всех подключенных ридеров. 

7. Почему ридеры Smartware быстрее чем pcsc? 
Начнем с того, что ридер Smartware подключается к рабочей станции через разъем Ethernet, 
который имеет скорость передачи информации в 100Гбит/с, когда разъем USB 2.0, 
используемый на большинстве станций имеет скорость в 480Мбит/c, 
что в 213 раз медленнее чем Ethernet.
Во-вторых, для общения с ридером Smartware используется вышеупомянутый язык программировния
TCPScript, с помощью которого команды быстро передаются и обрабатываются ридером. 

8. В результате данной работы было реализовано дополнение для драйвера Embosser Smartware,
осуществляющее запись карт через один или несколько ридеров Smartware. 
Данная доработку планируется добавить в следующую версию приложения, 
а также в дальнейшем поддерживать.